<style type="text/css">
.profile{
  border-radius: 50%;
  margin-top: -5px;
  margin-right: 5px;
  float: left;
  background-size: auto 100%; /* Interchange this value depending on prefering width vs. height */
  width: 30px;
  height: 30px;
  
}
body{
  overflow-y: scroll;
}
::-webkit-scrollbar-track {
  background-color: #F4F4F4;
}
::-webkit-scrollbar {
  width: 6px;
  background: #F4F4F4;
}
::-webkit-scrollbar-thumb {
  background: #dad7d7;
}

</style>

<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.1/css/all.css" integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="css/dashboard.css">
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top flex-md-nowrap p-0">

  <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#"><center><img style="border-radius: 0px;max-width: 80px;width: auto; position: relative;" src="imagens/logo.png"></center></a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav mr-auto">

      <li class="nav-item active">
        <div class="input-group">
          <div style="margin-left: 5px;">
          <!--
            <select id="insearch" class="js-example-basic-multiple" multiple="multiple" style="border-top-left-radius:3px; border-bottom-left-radius:3px; border-top-right-radius: 0px;border-bottom-right-radius: 0px; margin-left: 5px;height: 36px;width: 362px;" placeholder="Pesquisar.."></select>-->
            <input id="insearch" class="form-control d-sm-none d-md-block d-none d-sm-block" style="border-top-left-radius:3px; border-bottom-left-radius:3px; border-top-right-radius: 0px;border-bottom-right-radius: 0px; margin-left: 5px;height: 38px;width: 362px;" placeholder="Pesquisar..">
            
          </div>

          <div class="input-group-btn">
            <button class="btn btn-default d-sm-none d-md-block d-none d-sm-block" id="search" style="border-top-left-radius:0px; border-bottom-left-radius:0px; border-top-right-radius: 3px;border-bottom-right-radius: 3px; height: 38px" type="submit">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
      </li>
      
      

    </ul>

    <ul class="navbar-nav ml-auto" style="margin-right: 30px;">
      <li class="nav-item active">
        <a class="nav-link" href="#"><?php echo $_SESSION["nome"] ; ?><img src="<?php echo $_SESSION['imagem'];?>" class="profile"></a>
      </li>
      <li class="nav-item dropdown dropleft">
        <a class="nav-link" href="#" id="navbarDropdown2" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i id="bell" class="far fa-bell"></i>
        </a>
        <div class="dropdown-menu "  style="width: 400px;height: auto;" id="bct" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="#">Não vistas</a>
          <div class="dropdown-divider">  </div>
          <div style="overflow-y: scroll;max-height: 70px;" id="nvisto"> </div>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Recentes</a>
          <div class="dropdown-divider" ></div>
          <div id="visto" style="overflow-y: scroll;max-height: 330px;"></div>
          <div class="dropdown-divider"></div>
          <a id="expandir" class="dropdown-item" href="#">Expandir</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="login.php">Página inicial</a>
      </li>

      <li class="nav-item d-block d-sm-none">
        <form class="form-inline" method="GET" action="perfil.php">
          <div class="input-group">
            <div>
          <!--
            <select id="insearch" class="js-example-basic-multiple" multiple="multiple" style="border-top-left-radius:3px; border-bottom-left-radius:3px; border-top-right-radius: 0px;border-bottom-right-radius: 0px; margin-left: 5px;height: 36px;width: 362px;" placeholder="Pesquisar.."></select>-->
            <input id="insearch" class="form-control" name="codigo" style="border-top-left-radius:3px; border-bottom-left-radius:3px; border-top-right-radius: 0px;border-bottom-right-radius: 0px; margin-left: 5px;height: 38px;width: 70%;" placeholder="Pesquisar..">
            
          </div>

          <div class="input-group-btn" style="margin-left: -70px;">
            <button class="btn btn-default" id="search" style="border-top-left-radius:0px; border-bottom-left-radius:0px; border-top-right-radius: 3px;border-bottom-right-radius: 3px; height: 38px;margin-left: 0px;" type="submit">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
      </form>
    </li> 


    <li class="nav-item d-sm-none d-md-block d-none d-sm-block">
      <div class="dropdown d-sm-none d-md-block d-none d-sm-block">
        <button type="button" class="btn btn-secondary dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-cog"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-right"">
          <a class="dropdown-item" href="form_alterar_usuario.php">Conta</a>
          <a class="dropdown-item" href="logout.php">Sair</a>

        </div>
      </div>
    </li>
    <li class="nav-item">
      <a class="nav-link d-block d-sm-none" href="form_alterar_usuario.php">Conta</a>
    </li><li class="nav-item">
      <a class="nav-link d-block d-sm-none" href="logout.php">Sair</a>
    </li>

  </ul>
</div>
</nav>
<script src="https://code.jquery.com/jquery-3.2.0.min.js" integrity="sha256-JAW99MJVpJBGcbzEuXk4Az05s/XyDdBomFqNlM3ic+I=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js" integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js" integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>
<script src="js/typeahead.bundle.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
<input type="hidden" id="gambiarra3"  value="<?php echo $cod_cliente; ?>">
<script>



  $.post("search.php",function(data) {

   var obj = jQuery.parseJSON(data);

   $('.js-example-basic-multiple').select2({
    minimumInputLength: 1,
    minimumResultsForSearch: 2,
    language: {
      inputTooShort: function () {
        return "Digite o nome da oficina";
      }
    }
    ,

    data: obj
  });



 })
  $("option").click(function(){
    alert(this.val())
  })

  $("#search").click(function(){
    window.location.replace("perfil.php?codigo="+$("#insearch").val());

  })
  $("#navbarDropdown2").click(function() {
    // refresh list

    var sla
    sla =0
    
    $.post( "server.php", { cliente: $("#gambiarra3").val()})
    .done(function( data ) {

     var obj = JSON.parse(data)

     for (var i in obj) {



      if (obj[i].visto == 1) {

        $("#visto").append("<ul style='margin-bottom:10px;margin-left:5px;' class='list-inline tirar novisto'> <li class='list-inline-item'> <img style='width:60px;height:60px;border-radius:50%;margin-top:-30px;' src="+obj[i].img+"></li><li class='list-inline-item'><ul class='list-inline'><li class='list-inline-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar disabled  ' href='#'><strong>"+obj[i].nome+"</strong></button></li><li class='list-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar' href='#'>"+obj[i].serv+"</button></li> </ul></li></ul>")

      }
      else{
        if (obj[i].status == 1) {
          $("#nvisto").prepend("<ul style='margin-bottom:10px;margin-left:5px;' class='list-inline tirar novisto'> <li class='list-inline-item'> <img style='width:60px;height:60px;border-radius:50%;margin-top:-60px;' src="+obj[i].img+"></li><li class='list-inline-item'><ul class='list-inline'><li class='list-inline-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar disabled  ' href='#'><strong>"+obj[i].nome+"</strong></button></li><li class='list-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar' href='#'>"+obj[i].serv+"</button></li><li style='margin-left:10px;' class='list-item'>Serviço foi para discussão </li></ul></li></ul>")
          sla =1;
        }
        else if (obj[i].status == 2) {
          $("#nvisto").prepend("<ul style='margin-bottom:10px;margin-left:5px;' class='list-inline tirar novisto'> <li class='list-inline-item'> <img style='width:60px;height:60px;border-radius:50%;margin-top:-60px;' src="+obj[i].img+"></li><li class='list-inline-item'><ul class='list-inline'><li class='list-inline-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar disabled  ' href='#'><strong>"+obj[i].nome+"</strong></button></li><li class='list-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar' href='#'>"+obj[i].serv+"</button></li><li style='margin-left:10px;' class='list-item'>Leve seu carro até a oficina </li></ul></li></ul>")
          sla =1;
        }
        else if (obj[i].status == 3) {
          $("#nvisto").prepend("<ul style='margin-bottom:10px;margin-left:5px;' class='list-inline tirar novisto'> <li class='list-inline-item'> <img style='width:60px;height:60px;border-radius:50%;margin-top:-60px;' src="+obj[i].img+"></li><li class='list-inline-item'><ul class='list-inline'><li class='list-inline-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar disabled  ' href='#'><strong>"+obj[i].nome+"</strong></button></li><li class='list-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar' href='#'>"+obj[i].serv+"</button></li><li style='margin-left:10px;' class='list-item'>O serviço está em progresso </li></ul></li></ul>")
          sla =1;
        }
        else if (obj[i].status == 4) {
          $("#nvisto").prepend("<ul style='margin-bottom:10px;margin-left:5px;' class='list-inline tirar novisto'> <li class='list-inline-item'> <img style='width:60px;height:60px;border-radius:50%;margin-top:-60px;' src="+obj[i].img+"></li><li class='list-inline-item'><ul class='list-inline'><li class='list-inline-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar disabled  ' href='#'><strong>"+obj[i].nome+"</strong></button></li><li class='list-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar' href='#'>"+obj[i].serv+"</button></li><li style='margin-left:10px;' class='list-item'>O serviço foi finalizado </li></ul></li></ul>")
          sla =1;
        }


      }


      
    }

  })

    $( ".tirar" ).each(function( index ) {
      $.post( "server.php", { visto: $(this).val()} );

      $(this).remove()

    })
  });

$("#expandir").click(function(){
  $.post( "server.php", { cliente: $("#gambiarra3").val()})
  .done(function( data ) {

   var obj = JSON.parse(data)

   for (var i in obj) {


    if (obj[i].visto == 1) {
      $("#karaio").after("<ul style='margin-bottom:10px;margin-left:5px;' class='list-inline tirar'> <li class='list-inline-item'> <img style='width:60px;height:60px;border-radius:50%;margin-top:-30px;' src="+obj[i].img+"></li><li class='list-inline-item'><ul class='list-inline'><li class='list-inline-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar disabled  ' href='#'><strong>"+obj[i].nome+"</strong></button></li><li class='list-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar' href='#'>"+obj[i].serv+"</button></li> </ul></li></ul>")
    }
    else{

      $("#karaio").after("<ul style='margin-bottom:10px;margin-left:5px;' class='list-inline tirar'> <li class='list-inline-item'> <img style='width:60px;height:60px;border-radius:50%;margin-top:-30px;' src="+obj[i].img+"></li><li class='list-inline-item'><ul class='list-inline'><li class='list-inline-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar disabled  ' href='#'><strong>"+obj[i].nome+"</strong></button></li><li class='list-item'><button value='"+obj[i].cod+"' class='dropdown-item not tirar' href='#'>"+obj[i].serv+"</button></li> </ul></li></ul>")
    }



  }

});

  $("#allservices").modal('show')
})


</script>
<div class="modal fade bd-example-modal-lg" id="allservices" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Todos os serviços em andamento</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" style="height: 400px;overflow-y: scroll;">
        <div  id="karaio"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>

      </div>
    </div>
  </div>
</div>
